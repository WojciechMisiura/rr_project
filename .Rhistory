Growth_MoM = round((Weekly_Sales - Rolling_Month) / Rolling_Month * 100, 2))
growth_df <- growth_df %>%
mutate(growth_df = lead(growth_df)) %>%
select(-c(3, 4))
growth_df$Year <- year(growth_df$Date)
growth_df$Month <- month(growth_df$Date)
super_bowl <- c('2010-02-28', '2011-02-28', '2012-02-28')
labour_day <- c('2010-09-30', '2011-09-30', '2012-09-30')
thanksgiving <- c('2010-11-30', '2011-11-30', '2012-11-30')
christmas <- c('2010-12-31', '2011-12-31', '2012-12-31')
g2010 <- growth_df %>%
filter(Year == 2010) %>%
summarize(Month = Month[which.max(growth_df$Growth_MoM)], Growth_MoM = max(growth_df$Growth_MoM))
g2011 <- growth_df %>%
filter(Year == 2011) %>%
summarize(Month = Month[which.max(growth_df$Growth_MoM)], Growth_MoM = max(growth_df$Growth_MoM))
g2012 <- growth_df %>%
filter(Year == 2012) %>%
summarize(Month = Month[which.max(growth_df$Growth_MoM)], Growth_MoM = max(growth_df$Growth_MoM))
# Create a data frame with the text labels
text_labels <- data.frame(
x = c(0.7, 0.2, 0.2, 0.75, 0.75, 0.75, 1.3, 1.3, 1.3),
y = c(0.85, 0.5, 0.3, 0.5, 0.3, 0.1, 0.5, 0.3, 0.1),
label = c("Highest Sales MoM Growth", "December", "42.35%", "December", "37.07%", "2011", "October", "27.46%", "2012"),
color = c("black", "blue", "gray", "blue", "gray", "gray", "blue", "gray", "gray"),
size = c(6, 12, 8, 12, 8, 8, 12, 8, 8),
fontface = c("bold", "bold", "bold", "bold", "bold", "bold", "bold", "bold", "bold"),
family = c("sans", "mono", "mono", "mono", "mono", "mono", "mono", "mono", "mono"),
vjust = c(0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5),
hjust = c(0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5)
)
# Create the plot
fig <- ggplot() +
theme_void() +
theme(plot.margin = margin(0, 0, 0, 0, "cm"))
# Add text elements to the plot
fig <- fig +
geom_text(data = text_labels, aes(x = x, y = y, label = label, color = color, size = size,
fontface = fontface, family = family, vjust = vjust, hjust = hjust))
# Show the plot
print(fig)
growth_df <- panel %>%
select(Date, Weekly_Sales) %>%
group_by(Date = as.yearmon(Date)) %>%
summarize(Weekly_Sales = sum(Weekly_Sales)) %>%
ungroup() %>%
mutate(Rolling_Month = lag(Weekly_Sales),
Growth_MoM = round((Weekly_Sales - Rolling_Month) / Rolling_Month * 100, 2))
growth_df <- growth_df %>%
mutate(growth_df = lead(growth_df)) %>%
select(-c(3, 4))
growth_df$Year <- year(growth_df$Date)
growth_df$Month <- month(growth_df$Date)
super_bowl <- c('2010-02-28', '2011-02-28', '2012-02-28')
labour_day <- c('2010-09-30', '2011-09-30', '2012-09-30')
thanksgiving <- c('2010-11-30', '2011-11-30', '2012-11-30')
christmas <- c('2010-12-31', '2011-12-31', '2012-12-31')
g2010 <- growth_df %>%
filter(Year == 2010) %>%
summarize(Month = Month[which.max(growth_df$Growth_MoM)], Growth_MoM = max(growth_df$Growth_MoM))
g2011 <- growth_df %>%
filter(Year == 2011) %>%
summarize(Month = Month[which.max(growth_df$Growth_MoM)], Growth_MoM = max(growth_df$Growth_MoM))
g2012 <- growth_df %>%
filter(Year == 2012) %>%
summarize(Month = Month[which.max(growth_df$Growth_MoM)], Growth_MoM = max(growth_df$Growth_MoM))
# Create a data frame with the text labels
text_labels <- data.frame(
x = c(0.7, 0.2, 0.2, 0.75, 0.75, 0.75, 1.3, 1.3, 1.3),
y = c(0.85, 0.5, 0.3, 0.5, 0.3, 0.1, 0.5, 0.3, 0.1),
label = c("Highest Sales MoM Growth", "December", "42.35%", "December", "37.07%", "2011", "October", "27.46%", "2012"),
color = c("black", "blue", "gray", "blue", "gray", "gray", "blue", "gray", "gray"),
size = c(6, 12, 8, 12, 8, 8, 12, 8, 8),
#fontface = c("bold", "bold", "bold", "bold", "bold", "bold", "bold", "bold", "bold"),
family = c("sans", "mono", "mono", "mono", "mono", "mono", "mono", "mono", "mono"),
vjust = c(0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5),
hjust = c(0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5)
)
# Create the plot
fig <- ggplot() +
theme_void() +
theme(plot.margin = margin(0, 0, 0, 0, "cm"))
# Add text elements to the plot
fig <- fig +
geom_text(data = text_labels, aes(x = x, y = y, label = label, color = color, size = size,
family = family, vjust = vjust, hjust = hjust))
# Show the plot
print(fig)
growth_df <- panel %>%
select(Date, Weekly_Sales) %>%
group_by(Date = as.yearmon(Date)) %>%
summarize(Weekly_Sales = sum(Weekly_Sales)) %>%
ungroup() %>%
mutate(Rolling_Month = lag(Weekly_Sales),
Growth_MoM = round((Weekly_Sales - Rolling_Month) / Rolling_Month * 100, 2))
growth_df <- growth_df %>%
mutate(growth_df = lead(growth_df)) %>%
select(-c(3, 4))
growth_df$Year <- year(growth_df$Date)
growth_df$Month <- month(growth_df$Date)
super_bowl <- c('2010-02-28', '2011-02-28', '2012-02-28')
labour_day <- c('2010-09-30', '2011-09-30', '2012-09-30')
thanksgiving <- c('2010-11-30', '2011-11-30', '2012-11-30')
christmas <- c('2010-12-31', '2011-12-31', '2012-12-31')
g2010 <- growth_df %>%
filter(Year == 2010) %>%
summarize(Month = Month[which.max(growth_df$Growth_MoM)], Growth_MoM = max(growth_df$Growth_MoM))
g2011 <- growth_df %>%
filter(Year == 2011) %>%
summarize(Month = Month[which.max(growth_df$Growth_MoM)], Growth_MoM = max(growth_df$Growth_MoM))
g2012 <- growth_df %>%
filter(Year == 2012) %>%
summarize(Month = Month[which.max(growth_df$Growth_MoM)], Growth_MoM = max(growth_df$Growth_MoM))
# Create a data frame with the text labels
text_labels <- data.frame(
x = c(0.7, 0.2, 0.2, 0.75, 0.75, 0.75, 1.3, 1.3, 1.3),
y = c(0.85, 0.5, 0.3, 0.5, 0.3, 0.1, 0.5, 0.3, 0.1),
label = c("Highest Sales MoM Growth", "December", "42.35%", "December", "37.07%", "2011", "October", "27.46%", "2012"),
#color = c("black", "blue", "gray", "blue", "gray", "gray", "blue", "gray", "gray"),
size = c(6, 12, 8, 12, 8, 8, 12, 8, 8),
fontface = c("bold", "bold", "bold", "bold", "bold", "bold", "bold", "bold", "bold"),
family = c("sans", "mono", "mono", "mono", "mono", "mono", "mono", "mono", "mono"),
vjust = c(0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5),
hjust = c(0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5)
)
# Create the plot
fig <- ggplot() +
theme_void() +
theme(plot.margin = margin(0, 0, 0, 0, "cm"))
# Add text elements to the plot
fig <- fig +
geom_text(data = text_labels, aes(x = x, y = y, label = label, size = size,
fontface = fontface, family = family, vjust = vjust, hjust = hjust))
# Show the plot
print(fig)
growth_df <- panel %>%
select(Date, Weekly_Sales) %>%
group_by(Date = as.yearmon(Date)) %>%
summarize(Weekly_Sales = sum(Weekly_Sales)) %>%
ungroup() %>%
mutate(Rolling_Month = lag(Weekly_Sales),
Growth_MoM = round((Weekly_Sales - Rolling_Month) / Rolling_Month * 100, 2))
growth_df <- growth_df %>%
mutate(growth_df = lead(growth_df)) %>%
select(-c(3, 4))
growth_df$Year <- year(growth_df$Date)
growth_df$Month <- month(growth_df$Date)
super_bowl <- c('2010-02-28', '2011-02-28', '2012-02-28')
labour_day <- c('2010-09-30', '2011-09-30', '2012-09-30')
thanksgiving <- c('2010-11-30', '2011-11-30', '2012-11-30')
christmas <- c('2010-12-31', '2011-12-31', '2012-12-31')
g2010 <- growth_df %>%
filter(Year == 2010) %>%
summarize(Month = Month[which.max(growth_df$Growth_MoM)], Growth_MoM = max(growth_df$Growth_MoM))
g2011 <- growth_df %>%
filter(Year == 2011) %>%
summarize(Month = Month[which.max(growth_df$Growth_MoM)], Growth_MoM = max(growth_df$Growth_MoM))
g2012 <- growth_df %>%
filter(Year == 2012) %>%
summarize(Month = Month[which.max(growth_df$Growth_MoM)], Growth_MoM = max(growth_df$Growth_MoM))
# Create a data frame with the text labels
text_labels <- data.frame(
x = c(0.7, 0.2, 0.2, 0.75, 0.75, 0.75, 1.3, 1.3, 1.3),
y = c(0.85, 0.5, 0.3, 0.5, 0.3, 0.1, 0.5, 0.3, 0.1),
label = c("Highest Sales MoM Growth", "December", "42.35%", "December", "37.07%", "2011", "October", "27.46%", "2012"),
#color = c("black", "blue", "gray", "blue", "gray", "gray", "blue", "gray", "gray"),
#size = c(6, 12, 8, 12, 8, 8, 12, 8, 8),
fontface = c("bold", "bold", "bold", "bold", "bold", "bold", "bold", "bold", "bold"),
family = c("sans", "mono", "mono", "mono", "mono", "mono", "mono", "mono", "mono"),
vjust = c(0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5),
hjust = c(0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5)
)
# Create the plot
fig <- ggplot() +
theme_void() +
theme(plot.margin = margin(0, 0, 0, 0, "cm"))
# Add text elements to the plot
fig <- fig +
geom_text(data = text_labels, aes(x = x, y = y, label = label,
fontface = fontface, family = family, vjust = vjust, hjust = hjust))
# Show the plot
print(fig)
# Create a data frame with the text labels
text_labels <- data.frame(
x = c(0.7, 0.2, 0.2, 0.75, 0.75, 0.75, 1.3, 1.3, 1.3),
y = c(0.85, 0.5, 0.3, 0.5, 0.3, 0.1, 0.5, 0.3, 0.1),
label = c("Highest Sales MoM Growth", "December", "42.35%", "December", "37.07%", "2011", "October", "27.46%", "2012"),
fontface = c("bold", "bold", "bold", "bold", "bold", "bold", "bold", "bold", "bold"),
family = c("sans", "mono", "mono", "mono", "mono", "mono", "mono", "mono", "mono"),
vjust = c(0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5),
hjust = c(0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5),
color = c("black", "blue", "gray", "blue", "gray", "gray", "blue", "gray", "gray"),
size = c(6, 12, 8, 12, 8, 8, 12, 8, 8)
)
# Create the plot
fig <- ggplot() +
theme_void() +
theme(plot.margin = margin(0, 0, 0, 0, "cm"))
# Add text elements to the plot
fig <- fig +
geom_text(data = text_labels, aes(x = x, y = y, label = label, fontface = fontface, family = family,
vjust = vjust, hjust = hjust, color = color, size = size),
show.legend = FALSE) +
scale_color_identity() +
scale_size_identity() +
annotate("text", x = 0.5, y = 0.95, label = "Custom Plot Title", size = 16, vjust = 1, hjust = 0.5,
fontface = "bold", family = "sans", color = "darkblue") +
annotate("text", x = 0.5, y = 0.1, label = "Additional Text", size = 10, vjust = 0, hjust = 0.5,
fontface = "italic", family = "sans", color = "darkgreen")
# Show the plot
print(fig)
# Create a data frame with the text labels
text_labels <- data.frame(
x = c(0.7, 0.2, 0.2, 0.75, 0.75, 0.75, 1.3, 1.3, 1.3),
y = c(0.85, 0.5, 0.3, 0.5, 0.3, 0.1, 0.5, 0.3, 0.1),
label = c("Highest Sales MoM Growth", "December", "42.35%", "December", "37.07%", "2011", "October", "27.46%", "2012"),
fontface = c("bold", "bold", "bold", "bold", "bold", "bold", "bold", "bold", "bold"),
family = c("sans", "mono", "mono", "mono", "mono", "mono", "mono", "mono", "mono"),
vjust = c(0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5),
hjust = c(0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5),
color = c("black", "blue", "gray", "blue", "gray", "gray", "blue", "gray", "gray"),
size = c(6, 12, 8, 12, 8, 8, 12, 8, 8)
)
# Create the plot
fig <- ggplot() +
theme_void() +
theme(plot.margin = margin(0, 0, 0, 0, "cm"))
# Add text elements to the plot
fig <- fig +
geom_text(data = text_labels, aes(x = x, y = y, label = label, fontface = fontface, family = family,
vjust = vjust, hjust = hjust, color = color, size = size),
show.legend = FALSE) +
scale_color_identity() +
scale_size_identity() +
annotate("text", x = 0.5, y = 0.95, size = 16, vjust = 1, hjust = 0.5,
fontface = "bold", family = "sans", color = "darkblue")
# Show the plot
print(fig)
# Create a data frame with the text labels
text_labels <- data.frame(
x = c(0.7, 0.2, 0.2, 0.75, 0.75, 0.75, 1.3, 1.3, 1.3),
y = c(0.85, 0.5, 0.3, 0.5, 0.3, 0.1, 0.5, 0.3, 0.1),
label = c("Highest Sales MoM Growth", "December", "42.35%", "December", "37.07%", "2011", "October", "27.46%", "2012"),
fontface = c("bold", "bold", "bold", "bold", "bold", "bold", "bold", "bold", "bold"),
family = c("sans", "mono", "mono", "mono", "mono", "mono", "mono", "mono", "mono"),
vjust = c(0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5),
hjust = c(0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5),
color = c("black", "blue", "gray", "blue", "gray", "gray", "blue", "gray", "gray"),
size = c(6, 12, 8, 12, 8, 8, 12, 8, 8)
)
# Create the plot
fig <- ggplot() +
theme_void() +
theme(plot.margin = margin(0, 0, 0, 0, "cm"))
# Add text elements to the plot
fig <- fig +
geom_text(data = text_labels, aes(x = x, y = y, label = label, fontface = fontface, family = family,
vjust = vjust, hjust = hjust, color = color, size = size),
show.legend = FALSE) +
scale_color_identity() +
scale_size_identity() +
annotate("text", x = 0.5, y = 0.95, size = 5, vjust = 1, hjust = 0.5,
fontface = "bold", family = "sans", color = "darkblue") +
annotate("text", x = 0.5, y = 0.1, label = "Additional Text", size = 2, vjust = 0, hjust = 0.5,
fontface = "italic", family = "sans", color = "darkgreen")
# Show the plot
print(fig)
# Create a data frame with the text labels
text_labels <- data.frame(
x = c(0.7, 0.2, 0.2, 0.75, 0.75, 0.75, 1.3, 1.3, 1.3),
y = c(0.85, 0.5, 0.3, 0.5, 0.3, 0.1, 0.5, 0.3, 0.1),
label = c("Highest Sales MoM Growth", "December", "42.35%", "December", "37.07%", "2011", "October", "27.46%", "2012"),
fontface = c("bold", "bold", "bold", "bold", "bold", "bold", "bold", "bold", "bold"),
family = c("sans", "mono", "mono", "mono", "mono", "mono", "mono", "mono", "mono"),
vjust = c(0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5),
hjust = c(0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5),
color = c("black", "blue", "gray", "blue", "gray", "gray", "blue", "gray", "gray"),
size = c(6, 12, 8, 12, 8, 8, 12, 8, 8)
)
# Create the plot
fig <- ggplot() +
theme_void() +
theme(plot.margin = margin(0, 0, 0, 0, "cm"))
# Add text elements to the plot
fig <- fig +
geom_text(data = text_labels, aes(x = x, y = y, label = label, fontface = fontface, family = family,
vjust = vjust, hjust = hjust, color = color, size = size),
show.legend = FALSE) +
scale_color_identity() +
scale_size_identity() +
annotate("text", x = 0.5, y = 0.95, label = "Custom Plot Title", size = 16, vjust = 1, hjust = 0.5,
fontface = "bold", family = "sans", color = "darkblue") +
annotate("text", x = 0.5, y = 0.1, label = "Additional Text", size = 10, vjust = 0, hjust = 0.5,
fontface = "italic", family = "sans", color = "darkgreen")
# Show the plot
print(fig)
# Create a data frame with the text labels
text_labels <- data.frame(
x = c(0.7, 0.2, 0.2, 0.75, 0.75, 0.75, 1.3, 1.3, 1.3),
y = c(0.85, 0.5, 0.3, 0.5, 0.3, 0.1, 0.5, 0.3, 0.1),
label = c("Highest Sales MoM Growth", "December", "42.35%", "December", "37.07%", "2011", "October", "27.46%", "2012"),
fontface = c("bold", "bold", "bold", "bold", "bold", "bold", "bold", "bold", "bold"),
family = c("sans", "mono", "mono", "mono", "mono", "mono", "mono", "mono", "mono"),
vjust = c(0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5),
hjust = c(0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5),
color = c("black", "blue", "gray", "blue", "gray", "gray", "blue", "gray", "gray"),
size = c(6, 12, 8, 12, 8, 8, 12, 8, 8)
)
# Create the plot
fig <- ggplot() +
theme_void() +
theme(plot.margin = margin(0, 0, 0, 0, "cm"))
# Add text elements to the plot
fig <- fig +
geom_text(data = text_labels, aes(x = x, y = y, label = label, fontface = fontface, family = family,
vjust = vjust, hjust = hjust, color = color, size = size),
show.legend = FALSE) +
scale_color_identity() +
scale_size_identity() +
annotate("text", x = 0.5, y = 0.95, label = "Custom Plot Title", size = 4, vjust = 1, hjust = 0.5,
fontface = "bold", family = "sans", color = "darkblue") +
annotate("text", x = 0.5, y = 0.1, label = "Additional Text", size = 2, vjust = 0, hjust = 0.5,
fontface = "italic", family = "sans", color = "darkgreen")
# Show the plot
print(fig)
# Create a data frame with the text labels
text_labels <- data.frame(
x = c(0.7, 0.2, 0.2, 0.75, 0.75, 0.75, 1.3, 1.3, 1.3),
y = c(0.85, 0.5, 0.3, 0.5, 0.3, 0.1, 0.5, 0.3, 0.1),
label = c("Highest Sales MoM Growth", "December", "42.35%", "December", "37.07%", "2011", "October", "27.46%", "2012"),
fontface = c("bold", "bold", "bold", "bold", "bold", "bold", "bold", "bold", "bold"),
family = c("sans", "mono", "mono", "mono", "mono", "mono", "mono", "mono", "mono"),
vjust = c(0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5),
hjust = c(0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5),
color = c("black", "blue", "gray", "blue", "gray", "gray", "blue", "gray", "gray"),
size = c(6, 12, 8, 12, 8, 8, 12, 8, 8)
)
# Create the plot
fig <- ggplot() +
theme_void() +
theme(plot.margin = margin(0, 0, 0, 0, "cm"))
# Add text elements to the plot
fig <- fig +
geom_text(data = text_labels, aes(x = x, y = y, label = label, fontface = fontface, family = family,
vjust = vjust, hjust = hjust, color = color, size = size),
show.legend = FALSE) +
scale_color_identity() +
scale_size_identity() +
annotate("text", x = 0.5, y = 0.95, label = "", size = 4, vjust = 1, hjust = 0.5,
fontface = "bold", family = "sans", color = "darkblue") +
annotate("text", x = 0.5, y = 0.1, label = "Additional Text", size = 2, vjust = 0, hjust = 0.5,
fontface = "italic", family = "sans", color = "darkgreen")
# Show the plot
print(fig)
# Create a data frame with the text labels
text_labels <- data.frame(
x = c(0.7, 0.2, 0.2, 0.75, 0.75, 0.75, 1.3, 1.3, 1.3),
y = c(0.85, 0.5, 0.3, 0.5, 0.3, 0.1, 0.5, 0.3, 0.1),
label = c("Highest Sales MoM Growth", "December", "33.35%", "December", "33.07%", "2011", "October", "33.46%", "2012"),
fontface = c("bold", "bold", "bold", "bold", "bold", "bold", "bold", "bold", "bold"),
family = c("sans", "mono", "mono", "mono", "mono", "mono", "mono", "mono", "mono"),
vjust = c(0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5),
hjust = c(0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5),
color = c("black", "blue", "gray", "blue", "gray", "gray", "blue", "gray", "gray"),
size = c(6, 12, 8, 12, 8, 8, 12, 8, 8)
)
# Create the plot
fig <- ggplot() +
theme_void() +
theme(plot.margin = margin(0, 0, 0, 0, "cm"))
# Add text elements to the plot
fig <- fig +
geom_text(data = text_labels, aes(x = x, y = y, label = label, fontface = fontface, family = family,
vjust = vjust, hjust = hjust, color = color, size = size),
show.legend = FALSE) +
scale_color_identity() +
scale_size_identity() +
annotate("text", x = 0.5, y = 0.95, label = "", size = 4, vjust = 1, hjust = 0.5,
fontface = "bold", family = "sans", color = "darkblue") +
annotate("text", x = 0.5, y = 0.1, label = "Additional Text", size = 2, vjust = 0, hjust = 0.5,
fontface = "italic", family = "sans", color = "darkgreen")
# Show the plot
print(fig)
# Create a data frame with the text labels
text_labels <- data.frame(
x = c(0.7, 0.2, 0.2, 0.75, 0.75, 0.75, 1.3, 1.3, 1.3),
y = c(0.85, 0.5, 0.3, 0.5, 0.3, 0.1, 0.5, 0.3, 0.1),
label = c("Highest Sales MoM Growth", "December", "20%", "December", "20%", "2011", "October", "20%", "2012"),
fontface = c("bold", "bold", "bold", "bold", "bold", "bold", "bold", "bold", "bold"),
family = c("sans", "mono", "mono", "mono", "mono", "mono", "mono", "mono", "mono"),
vjust = c(0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5),
hjust = c(0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5),
color = c("black", "blue", "gray", "blue", "gray", "gray", "blue", "gray", "gray"),
size = c(6, 12, 8, 12, 8, 8, 12, 8, 8)
)
# Create the plot
fig <- ggplot() +
theme_void() +
theme(plot.margin = margin(0, 0, 0, 0, "cm"))
# Add text elements to the plot
fig <- fig +
geom_text(data = text_labels, aes(x = x, y = y, label = label, fontface = fontface, family = family,
vjust = vjust, hjust = hjust, color = color, size = size),
show.legend = FALSE) +
scale_color_identity() +
scale_size_identity() +
annotate("text", x = 0.5, y = 0.95, label = "", size = 4, vjust = 1, hjust = 0.5,
fontface = "bold", family = "sans", color = "darkblue") +
annotate("text", x = 0.5, y = 0.1, label = "Additional Text", size = 2, vjust = 0, hjust = 0.5,
fontface = "italic", family = "sans", color = "darkgreen")
# Show the plot
print(fig)
# Create a data frame with the text labels
text_labels <- data.frame(
x = c(0.7, 0.2, 0.2, 0.75, 0.75, 0.75, 1.3, 1.3, 1.3),
y = c(0.85, 0.5, 0.3, 0.5, 0.3, 0.1, 0.5, 0.3, 0.1),
label = c("Highest Sales MoM Growth", "December", "5%", "December", "5%", "2011", "October", "5%", "2012"),
fontface = c("bold", "bold", "bold", "bold", "bold", "bold", "bold", "bold", "bold"),
family = c("sans", "mono", "mono", "mono", "mono", "mono", "mono", "mono", "mono"),
vjust = c(0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5),
hjust = c(0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5),
color = c("black", "blue", "gray", "blue", "gray", "gray", "blue", "gray", "gray"),
size = c(6, 12, 8, 12, 8, 8, 12, 8, 8)
)
# Create the plot
fig <- ggplot() +
theme_void() +
theme(plot.margin = margin(0, 0, 0, 0, "cm"))
# Add text elements to the plot
fig <- fig +
geom_text(data = text_labels, aes(x = x, y = y, label = label, fontface = fontface, family = family,
vjust = vjust, hjust = hjust, color = color, size = size),
show.legend = FALSE) +
scale_color_identity() +
scale_size_identity() +
annotate("text", x = 0.5, y = 0.95, label = "", size = 4, vjust = 1, hjust = 0.5,
fontface = "bold", family = "sans", color = "darkblue") +
annotate("text", x = 0.5, y = 0.1, label = "Additional Text", size = 2, vjust = 0, hjust = 0.5,
fontface = "italic", family = "sans", color = "darkgreen")
# Show the plot
print(fig)
library(ggplot2)
# Create a data frame with the text labels
text_labels <- data.frame(
x = c(0.7, 0.2, 0.2, 0.75, 0.75, 0.75, 1.3, 1.3, 1.3),
y = c(0.85, 0.5, 0.3, 0.5, 0.3, 0.1, 0.5, 0.3, 0.1),
label = c("Highest Sales MoM Growth", "December", "42.35%", "December", "37.07%", "2011", "October", "27.46%", "2012"),
#color = c("black", "blue", "gray", "blue", "gray", "gray", "blue", "gray", "gray"),
#size = c(6, 12, 8, 12, 8, 8, 12, 8, 8),
fontface = c("bold", "bold", "bold", "bold", "bold", "bold", "bold", "bold", "bold"),
family = c("sans", "mono", "mono", "mono", "mono", "mono", "mono", "mono", "mono"),
vjust = c(0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5),
hjust = c(0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5)
)
# Create the plot
fig <- ggplot() +
theme_void() +
theme(plot.margin = margin(0, 0, 0, 0, "cm"))
# Add text elements to the plot
fig <- fig +
geom_text(data = text_labels, aes(x = x, y = y, label = label,
fontface = fontface, family = family, vjust = vjust, hjust = hjust))
# Show the plot
print(fig)
growth_df <- panel %>%
select(Date, Weekly_Sales) %>%
group_by(Date = as.yearmon(Date)) %>%
summarize(Weekly_Sales = sum(Weekly_Sales)) %>%
ungroup() %>%
mutate(Rolling_Month = lag(Weekly_Sales),
Growth_MoM = round((Weekly_Sales - Rolling_Month) / Rolling_Month * 100, 2))
growth_df <- growth_df %>%
mutate(growth_df = lead(growth_df)) %>%
select(-c(3, 4))
growth_df$Year <- year(growth_df$Date)
growth_df$Month <- month(growth_df$Date)
super_bowl <- c('2010-02-28', '2011-02-28', '2012-02-28')
labour_day <- c('2010-09-30', '2011-09-30', '2012-09-30')
thanksgiving <- c('2010-11-30', '2011-11-30', '2012-11-30')
christmas <- c('2010-12-31', '2011-12-31', '2012-12-31')
g2010 <- growth_df %>%
filter(Year == 2010) %>%
summarize(Month = Month[which.max(growth_df$Growth_MoM)], Growth_MoM = max(growth_df$Growth_MoM))
g2011 <- growth_df %>%
filter(Year == 2011) %>%
summarize(Month = Month[which.max(growth_df$Growth_MoM)], Growth_MoM = max(growth_df$Growth_MoM))
g2012 <- growth_df %>%
filter(Year == 2012) %>%
summarize(Month = Month[which.max(growth_df$Growth_MoM)], Growth_MoM = max(growth_df$Growth_MoM))
# Create a data frame with the text labels
text_labels <- data.frame(
x = c(0.7, 0.2, 0.2, 0.75, 0.75, 0.75, 1.3, 1.3, 1.3),
y = c(0.85, 0.5, 0.3, 0.5, 0.3, 0.1, 0.5, 0.3, 0.1),
label = c("Highest Sales MoM Growth", "December", "42.35%", "December", "37.07%", "2011", "October", "27.46%", "2012"),
#color = c("black", "blue", "gray", "blue", "gray", "gray", "blue", "gray", "gray"),
#size = c(6, 12, 8, 12, 8, 8, 12, 8, 8),
fontface = c("bold", "bold", "bold", "bold", "bold", "bold", "bold", "bold", "bold"),
family = c("sans", "mono", "mono", "mono", "mono", "mono", "mono", "mono", "mono"),
vjust = c(0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5),
hjust = c(0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5)
)
# Create the plot
fig <- ggplot() +
theme_void() +
theme(plot.margin = margin(0, 0, 0, 0, "cm"))
# Add text elements to the plot
fig <- fig +
geom_text(data = text_labels, aes(x = x, y = y, label = label,
fontface = fontface, family = family, vjust = vjust, hjust = hjust))
# Show the plot
print(fig)
View(data)
