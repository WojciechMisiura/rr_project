library(readr)
library(dplyr)
library(ggplot2)
library(lubridate)
url<-"https://raw.githubusercontent.com/WojciechMisiura/rr_project/main/Walmart_Store_sales.csv" #as we already added our dataset to github, we will read data directly from github
data<-read_csv(url)
head(data)
url<-"https://raw.githubusercontent.com/WojciechMisiura/rr_project/main/Walmart_Store_sales.csv" #as we already added our dataset to github, we will read data directly from github
data<-read_csv(url)
head(data)
spec(data)
data$Date <- as.Date(data$Date, format = "%d-%m-%Y")
data$Weekly_Sales <- round(data$Weekly_Sales / 1000, 3)
data$CPI <- round(data$CPI, 2)
data2 <- data
data2 <- data2[order(data2$Date), ]
panel <- data2 %>%
group_by(Store, Date) %>%
summarise(
Weekly_Sales = mean(Weekly_Sales),
Holiday_Flag = mean(Holiday_Flag),
Temperature = mean(Temperature),
Fuel_Price = mean(Fuel_Price),
CPI = mean(CPI),
Unemployment = mean(Unemployment),
.groups = "drop"
)
panel$Month <- month(panel$Date)
panel$Year <- year(panel$Date)
head(panel)
data_sub <- data[, !(names(data) %in% c('Month', 'Year', 'Store'))]
summary(data_sub)
View(data)
install.packages("zoo")
library(readr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(zoo)
holiday_date <- as.Date(c('2010-02-12', '2010-09-10',
'2010-11-26', '2010-12-31',
'2011-02-11', '2011-09-09',
'2011-11-25', '2011-12-30',
'2012-02-10', '2012-09-07'))
locate <- as.Date('2011-05-06')
agg_sales <- aggregate(panel$Weekly_Sales, by = list(Date = panel$Date), FUN = sum)
ggplot(agg_sales, aes(x = Date, y = x)) +
geom_line(color = "blue", size = 1, linetype = "solid") +
geom_line(data = transform(agg_sales, x = rollmean(x, k = 12, fill = NA)),
aes(x = Date, y = x), color = "red", size = 1, linetype = "solid") +
geom_vline(xintercept = as.numeric(holiday_date), color = "red", alpha = 0.2, linetype = "dashed") +
labs(title = "Walmart Aggregate Sales Trend\n(In Thousand Dollars)",
x = "", y = "") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1))
library(ggplot2)
holiday_date <- as.Date(c('2010-02-12', '2010-09-10',
'2010-11-26', '2010-12-31',
'2011-02-11', '2011-09-09',
'2011-11-25', '2011-12-30',
'2012-02-10', '2012-09-07'))
locate <- as.Date('2011-05-06')
agg_sales <- aggregate(panel$Weekly_Sales, by = list(Date = panel$Date), FUN = sum)
ggplot(agg_sales, aes(x = Date, y = x)) +
geom_line(color = "blue", size = 1, linetype = "solid") +
geom_line(data = transform(agg_sales, x = rollmean(x, k = 12, fill = NA)),
aes(x = Date, y = x), color = "red", size = 1, linetype = "solid") +
geom_vline(xintercept = as.numeric(holiday_date), color = "red", alpha = 0.2, linetype = "dashed") +
labs(title = "Walmart Aggregate Sales Trend\n(In Thousand Dollars)",
x = "", y = "") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(hjust = 0.5))
holiday_date <- as.Date(c('2010-02-12', '2010-09-10',
'2010-11-26', '2010-12-31',
'2011-02-11', '2011-09-09',
'2011-11-25', '2011-12-30',
'2012-02-10', '2012-09-07'))
locate <- as.Date('2011-05-06')
agg_sales <- aggregate(panel$Weekly_Sales, by = list(Date = panel$Date), FUN = sum)
ggplot(agg_sales, aes(x = Date, y = x)) +
geom_line(color = "steelblue", size = 1) +
geom_line(data = transform(agg_sales, x = rollmean(x, k = 12, fill = NA)),
aes(x = Date, y = x), color = "firebrick", size = 1) +
geom_vline(xintercept = as.numeric(holiday_date), color = "darkred", alpha = 0.2, linetype = "dashed") +
labs(title = "Walmart Aggregate Sales Trend\n(In Thousand Dollars)",
x = NULL, y = NULL) +
theme_bw() +
theme(plot.title = element_text(size = 20, face = "bold", hjust = 0.5),
axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 1),
axis.text.y = element_text(size = 12),
axis.title = element_text(size = 14),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_rect(fill = "white"),
plot.margin = margin(20, 20, 20, 20, "pt"))
holiday_date <- as.Date(c('2010-02-12', '2010-09-10',
'2010-11-26', '2010-12-31',
'2011-02-11', '2011-09-09',
'2011-11-25', '2011-12-30',
'2012-02-10', '2012-09-07'))
locate <- as.Date('2011-05-06')
agg_sales <- aggregate(panel$Weekly_Sales, by = list(Date = panel$Date), FUN = sum)
ggplot(agg_sales, aes(x = Date, y = x)) +
geom_line(color = "blue", size = 1, linetype = "solid") +
geom_line(data = transform(agg_sales, x = rollmean(x, k = 12, fill = NA)),
aes(x = Date, y = x), color = "red", size = 1, linetype = "solid") +
geom_vline(xintercept = as.numeric(holiday_date), color = "red", alpha = 0.2, linetype = "dashed") +
labs(title = "Walmart Aggregate Sales Trend\n(In Thousand Dollars)",
x = "", y = "") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(hjust = 0.5))
